## `Unsecure function`
- Obtain value
```
unsecure: getRequestURL() getRequestURI()
secure: getServletPath() getPathInfo()
```
- examine function: 
```
unsecure: startswith()  endswith() contains() indexof()
secure: equals()
```
- exploit

```
//   /./   /getInfo;login    /login/../getInfo  URLencode
```
- Case
- [Unsecure getRequestURI](https://www.jianshu.com/p/58b60311b5cf)



## `frontend and backend`
- F5 RCE
- Orange : Nginx, tomcat


## `Logic Judgement`
- *Bypass* logic in filter/interceptor
  - except/whitelist: no need auth
  - order: wrong filter chain
- Specific _Header_ examine 
- IP examine bypass: XFF header
- wrong if/else and return handling logic
- core judgement logic : make it equal
- verifycode reuse: getSession()
- API not public: query sensitive information


## Other
- getClientIP
  - getHeader("X-Forwarded-For")


# Detection
- develop rules based on web-logs : access 403
