# `Vulnerability`
## 1. Command executing
- subprocess.Popen('ls',shell=True,stdout)
  - shell = True
  - pipe.quote()
- child_process.spawn

## 2. Deserialization
- marshal
- yaml.safe_load()
- pickle/cpickle
  - cPickle.loads()
- shelve
- PIL
- Unzip

## 3. File Access
- Zipfile


## 4. XXE
- xml.dom.*
- xml.etree.ElementTree
- xml.sax.*


## 5. SQL Injection
- cursor.excute()
- ORM.raw()|extra()
- Safe:
  - ModelInstance.objects.raw(sql,[])
  - connnection.objects.execute(sql,[])

## 6. SSRF
- requests.get()
- urllib.request.urlopen()

## 7. XSS/Redirection
- HttpResponseRedirect
- HttpResponse('Hello %s' %(name))
- render_to_response('hello.html',{'name': input})


## 8. SandBox Bypass
- [[PyJail] python沙箱逃逸探究](https://zhuanlan.zhihu.com/p/579183067)
  ```
  import _posixsubprocess
  _posixsubprocess.fork_exec([])
  ```
- [python 沙箱逃逸与SSTI](https://misakikata.github.io/2020/04/python-%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E4%B8%8ESSTI/)

## 9. Vulnerable Function
### Random
- unsafe : random.randint(1,100)
- safe : /dev/random


# Examples
## Code Injection
- Case1:
```python
 echo 'input'
 return 0

 input = '%0d%0a%20%20os.popen('touch test.txt')%0d%0a#

 echo ''
 os.popen('touch test.txt')
 #'return 0
```
- Case2:
```python
def trans_file():
    filename = raw_input("Provide the file:")
    command = 'ffmepeg -i "{source}" out.mpg'.format(source=filename)
    subprocess.call(command,shell=True)
```
## XXE
```python
from lxml import etree

tree = etree.parse('test.xml')
print etree.tostring(tree.getroot())


```
