# Function
- Upload
- Import
- 

# File Type
- [Backend script upload](https://github.com/Jayway007/Offense-and-Deffense/tree/main/Offense/Pentest/Common-vul/File%20Upload/Backend)

- [Frontend script upload](https://github.com/Jayway007/Offense-and-Deffense/tree/main/Offense/Pentest/Common-vul/File%20Upload/Frontend)


- [Picture  upload](https://github.com/Jayway007/Offense-and-Deffense/tree/main/Offense/Pentest/Common-vul/File%20Upload/Picture)


- [Document upload](https://github.com/Jayway007/Offense-and-Deffense/tree/main/Offense/Pentest/Common-vul/File%20Upload/Document)


# Exploit
- RCE 
  - jsp, jspx, jar, war
- cross directory
  - ../——%2e, %2f, %5c
- Race condition
- Other vulnerabiity
  - XSS
  - XXE
  - File read
  - DoS
    - high compression ratio archive

# Mitigation

- ***White-listing*** :  white-list the allowed file extensions so as to filter-out the malicious scripts or other executable file

- ***Restricting the name-length and file-size***: Imposing restrictions on the name-length and file size will help to prevent a DoS attack.

- ***Storage location of the uploaded files*** : The files uploaded by the user should be stored in a separate directory outside the Webroot or the public directory of the website. This will ensure that even if the attacker succeeds in uploading a malicious file, he will not be able to execute it using a web URL.

- ***Scanning the files for malware and other malicious content***: All uploaded files should be scanned for malware and other malicious scripts before saving them to the desired location.


# Best Practice
- verify the extension and content of file uploaded, rename the file and store in a separate directory, access the file by API not a pure path.

## Reference
- [file-upload-checklist_blog](https://www.onsecurity.io/blog/file-upload-checklist/)
