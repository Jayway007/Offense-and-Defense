# File Type
- [Backend script upload](https://github.com/Jayway007/Offense-and-Deffense/tree/main/Offense/Pentest/Common-vul/File%20Upload/Backend)

- [Frontend script upload](https://github.com/Jayway007/Offense-and-Deffense/tree/main/Offense/Pentest/Common-vul/File%20Upload/Frontend)


- [Picture  upload](https://github.com/Jayway007/Offense-and-Deffense/tree/main/Offense/Pentest/Common-vul/File%20Upload/Picture)


- [Document upload](https://github.com/Jayway007/Offense-and-Deffense/tree/main/Offense/Pentest/Common-vul/File%20Upload/Document)


# Exploit
- RCE
- cross directory
- Other vulnerabiity
  - XSS
  - XXE
  - File read
  - DoS
    - high compression ratio archive

# Mitigation

- ***White-listing*** : You can white-list the allowed file extensions so as to filter-out the malicious scripts or other executable file on both i.e. client as well a server side

- ***Client and Server-side verification of uploaded file***: Verifying the filename and extension being uploaded for the allowed formatfrom the client-side is the same as the one being saved on the server-side will ensure that attacker is not able to intercept the request and change the filename or extension.

- ***Restricting the name-length and file-size***: Imposing restrictions on the name-length and file size will help to prevent a DoS attack.

- ***Storage location of the uploaded files*** : The files uploaded by the user should be stored in a separate directory outside the Webroot or the public directory of the website. This will ensure that even if the attacker succeeds in uploading a malicious file, he will not be able to execute it using a web URL.

- ***Error Handling for Wrong File Upload***: While displaying errors for wrong file uploads, directory paths should be excluded so that the attacker does not gain access to the server using directory traversal attacks.

- ***Scanning the files for malware and other malicious content***: All uploaded files should be scanned for malware and other malicious scripts before saving them to the desired location.

## Reference
- [file-upload-checklist_blog](https://www.onsecurity.io/blog/file-upload-checklist/)
